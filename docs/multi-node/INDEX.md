# openGauss å¤šèŠ‚ç‚¹é›†ç¾¤éƒ¨ç½² - æ–‡ä»¶æ¸…å•

æœ¬ç›®å½•åŒ…å« openGauss ä¸€ä¸»ä¸¤å¤‡é›†ç¾¤çš„å®Œæ•´éƒ¨ç½²æ–¹æ¡ˆã€‚

## ğŸ“ ç›®å½•ç»“æ„

```
docs/multi-node/
â”œâ”€â”€ README.md              # ä¸»æ–‡æ¡£ - è¯¦ç»†éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ QUICKSTART.md          # å¿«é€Ÿå¼€å§‹æŒ‡å—
â”œâ”€â”€ ARCHITECTURE.md        # æ¶æ„è¯´æ˜å’Œæµç¨‹å›¾
â”œâ”€â”€ scripts/               # éƒ¨ç½²è„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ 01_create_containers.ps1   # Windows: åˆ›å»º Docker å®¹å™¨
â”‚   â”œâ”€â”€ 01_create_containers.sh    # Linux/macOS: åˆ›å»º Docker å®¹å™¨
â”‚   â”œâ”€â”€ 02_setup_ssh.sh            # é…ç½® SSH äº’ä¿¡
â”‚   â”œâ”€â”€ 03_init_cluster.sh         # åˆå§‹åŒ–é›†ç¾¤
â”‚   â”œâ”€â”€ 04_start_cluster.sh        # å¯åŠ¨é›†ç¾¤
â”‚   â”œâ”€â”€ 05_verify_cluster.sh       # éªŒè¯é›†ç¾¤çŠ¶æ€
â”‚   â”œâ”€â”€ 06_stop_cluster.sh         # åœæ­¢é›†ç¾¤
â”‚   â””â”€â”€ 07_test_failover.sh        # æ•…éšœåˆ‡æ¢æµ‹è¯•
â””â”€â”€ config/                # é…ç½®æ–‡ä»¶ç›®å½•
    â”œâ”€â”€ README.md          # é…ç½®æ–‡ä»¶è¯´æ˜
    â””â”€â”€ cluster_config.xml # é›†ç¾¤é…ç½®æ¨¡æ¿
```

## ğŸ“„ æ–‡ä»¶è¯´æ˜

### æ–‡æ¡£æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `README.md` | è¯¦ç»†éƒ¨ç½²æŒ‡å—ï¼ŒåŒ…å«å®Œæ•´çš„éƒ¨ç½²æ­¥éª¤ã€ç®¡ç†å‘½ä»¤å’Œæ•…éšœæ’æŸ¥ |
| `QUICKSTART.md` | å¿«é€Ÿå¼€å§‹æŒ‡å—ï¼Œ5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²é›†ç¾¤ |
| `ARCHITECTURE.md` | æ¶æ„å›¾å’Œæµç¨‹è¯´æ˜ï¼ŒåŒ…å«æ•°æ®å¤åˆ¶ã€æ•…éšœåˆ‡æ¢ç­‰æµç¨‹å›¾ |

### è„šæœ¬æ–‡ä»¶

#### å®¿ä¸»æœºæ‰§è¡Œè„šæœ¬

| è„šæœ¬ | å¹³å° | åŠŸèƒ½ |
|------|------|------|
| `01_create_containers.ps1` | Windows PowerShell | åˆ›å»º Docker ç½‘ç»œå’Œ 3 ä¸ªå®¹å™¨èŠ‚ç‚¹ |
| `01_create_containers.sh` | Linux/macOS | åˆ›å»º Docker ç½‘ç»œå’Œ 3 ä¸ªå®¹å™¨èŠ‚ç‚¹ |

**æ‰§è¡Œä½ç½®**: åœ¨å®¿ä¸»æœºçš„ `docs/multi-node/scripts` ç›®å½•ä¸‹æ‰§è¡Œ

#### å®¹å™¨å†…æ‰§è¡Œè„šæœ¬

ä»¥ä¸‹è„šæœ¬éœ€è¦åœ¨ä¸»èŠ‚ç‚¹å®¹å™¨å†…ä»¥ root èº«ä»½æ‰§è¡Œï¼š

| è„šæœ¬ | åŠŸèƒ½ | æ‰§è¡Œé¡ºåº |
|------|------|---------|
| `02_setup_ssh.sh` | é…ç½®æ‰€æœ‰èŠ‚ç‚¹é—´çš„ SSH äº’ä¿¡ | ç¬¬1æ­¥ |
| `03_init_cluster.sh` | åˆå§‹åŒ–æ•°æ®åº“å’Œä¸»å¤‡é…ç½® | ç¬¬2æ­¥ |
| `04_start_cluster.sh` | å¯åŠ¨æ‰€æœ‰èŠ‚ç‚¹æ•°æ®åº“ | ç¬¬3æ­¥ |
| `05_verify_cluster.sh` | éªŒè¯é›†ç¾¤çŠ¶æ€å’Œä¸»å¤‡åŒæ­¥ | ç¬¬4æ­¥ |
| `06_stop_cluster.sh` | åœæ­¢é›†ç¾¤ï¼ˆå¯é€‰ï¼‰ | ç®¡ç†å·¥å…· |
| `07_test_failover.sh` | æµ‹è¯•æ•…éšœåˆ‡æ¢ï¼ˆå¯é€‰ï¼‰ | æµ‹è¯•å·¥å…· |

**æ‰§è¡Œä½ç½®**: åœ¨ä¸»èŠ‚ç‚¹å®¹å™¨çš„ `/home/scripts` ç›®å½•ä¸‹æ‰§è¡Œ

### é…ç½®æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `config/cluster_config.xml` | openGauss é›†ç¾¤é…ç½®æ¨¡æ¿ï¼ˆä¾›å‚è€ƒï¼‰ |
| `config/README.md` | é…ç½®æ–‡ä»¶è¯¦ç»†è¯´æ˜ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. Windows PowerShell

```powershell
# åœ¨å®¿ä¸»æœºæ‰§è¡Œ
cd docs\multi-node\scripts
.\01_create_containers.ps1

# å¤åˆ¶è„šæœ¬åˆ°å®¹å™¨
docker cp . opengauss-primary:/home/scripts/

# è¿›å…¥å®¹å™¨
docker exec -it opengauss-primary bash

# åœ¨å®¹å™¨å†…æ‰§è¡Œ
cd /home/scripts
bash 02_setup_ssh.sh
bash 03_init_cluster.sh
bash 04_start_cluster.sh
bash 05_verify_cluster.sh
```

### 2. Linux / macOS

```bash
# åœ¨å®¿ä¸»æœºæ‰§è¡Œ
cd docs/multi-node/scripts
bash 01_create_containers.sh

# å¤åˆ¶è„šæœ¬åˆ°å®¹å™¨
docker cp . opengauss-primary:/home/scripts/

# è¿›å…¥å®¹å™¨
docker exec -it opengauss-primary bash

# åœ¨å®¹å™¨å†…æ‰§è¡Œ
cd /home/scripts
bash 02_setup_ssh.sh
bash 03_init_cluster.sh
bash 04_start_cluster.sh
bash 05_verify_cluster.sh
```

## ğŸ¯ éƒ¨ç½²ç›®æ ‡

å®Œæˆéƒ¨ç½²åï¼Œä½ å°†è·å¾—ï¼š

- âœ… 3 ä¸ª openGauss æ•°æ®åº“èŠ‚ç‚¹ï¼ˆ1ä¸»2å¤‡ï¼‰
- âœ… è‡ªåŠ¨é…ç½®çš„ä¸»å¤‡å¤åˆ¶
- âœ… SSH å…å¯†äº’ä¿¡
- âœ… å®Œæ•´çš„ç›‘æ§å’Œç®¡ç†è„šæœ¬
- âœ… æ•…éšœåˆ‡æ¢èƒ½åŠ›

## ğŸ”§ èŠ‚ç‚¹ä¿¡æ¯

| èŠ‚ç‚¹ | å®¹å™¨å | IP åœ°å€ | ç«¯å£æ˜ å°„ | è§’è‰² |
|------|--------|---------|---------|------|
| ä¸»èŠ‚ç‚¹ | opengauss-primary | 172.18.0.10 | 15432 â†’ 5432 | Primary |
| å¤‡èŠ‚ç‚¹1 | opengauss-standby1 | 172.18.0.11 | 15433 â†’ 5432 | Standby |
| å¤‡èŠ‚ç‚¹2 | opengauss-standby2 | 172.18.0.12 | 15434 â†’ 5432 | Standby |

## ğŸ“š å»¶ä¼¸é˜…è¯»

- [openGauss å®˜æ–¹æ–‡æ¡£](https://docs.opengauss.org/)
- [ä¸» README](../../README.md) - å•èŠ‚ç‚¹éƒ¨ç½²å’Œè°ƒè¯•
- [2025.11.26 å·¥ä½œæ€»ç»“](../2025.11.26/note.md) - VS Code è°ƒè¯•é…ç½®

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒè¦æ±‚**: 
   - Docker Desktop å·²å¯åŠ¨
   - è‡³å°‘ 4GB å¯ç”¨å†…å­˜
   - ç«¯å£ 15432-15434 æœªè¢«å ç”¨

2. **ç½‘ç»œé…ç½®**:
   - ä½¿ç”¨ 172.18.0.0/16 ç½‘æ®µ
   - ç¡®ä¿ä¸ä¸ç°æœ‰ç½‘ç»œå†²çª

3. **æ•°æ®æŒä¹…åŒ–**:
   - å®¹å™¨åˆ é™¤åæ•°æ®ä¼šä¸¢å¤±
   - ç”Ÿäº§ç¯å¢ƒå»ºè®®æŒ‚è½½æ•°æ®å·

4. **å®‰å…¨æ€§**:
   - ç¤ºä¾‹ä½¿ç”¨ç®€å•å¯†ç  `omm_1234`
   - ç”Ÿäº§ç¯å¢ƒéœ€è¦åŠ å¼ºå®‰å…¨é…ç½®

## ğŸ› æ•…éšœæ’æŸ¥

é‡åˆ°é—®é¢˜ï¼Ÿè¯·æŸ¥çœ‹ï¼š

- [README.md - å¸¸è§é—®é¢˜](README.md#å¸¸è§é—®é¢˜)
- [QUICKSTART.md - æ•…éšœæ’æŸ¥](QUICKSTART.md#ä¸ƒæ•…éšœæ’æŸ¥)

## ğŸ¤ è´¡çŒ®

å¦‚æœ‰æ”¹è¿›å»ºè®®æˆ–å‘ç°é—®é¢˜ï¼Œæ¬¢è¿æäº¤ Issue æˆ– Pull Requestã€‚

---

**æ›´æ–°æ—¶é—´**: 2025å¹´11æœˆ11æ—¥  
**ç‰ˆæœ¬**: v1.0
